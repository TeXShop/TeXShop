<HTML>

<HEAD>
		<META HTTP-EQUIV="content-type" CONTENT="text/html;charset=iso-8859-1">
		<TITLE>Default AppleScript Macros</TITLE>
		<META NAME="copyright" CONTENT="Copyright (c) 2003 Richard Koch under the GNU FDL">
		<META NAME="description" CONTENT="applescript">
	</HEAD>

<BODY BGCOLOR="#ffffff">
		<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%">
<TR HEIGHT="40">
<TD WIDTH="40" HEIGHT="40"><a href="../TeXShop%20Help.html"><IMG HEIGHT="40" WIDTH="40" border="0" SRC="../gfx/xicnsc.gif"></a></TD>
<TD WIDTH="6" HEIGHT="40"></TD>
<TD HEIGHT="40" VALIGN="middle"><FONT FACE="Lucida Grande,Helvetica,Arial" SIZE="4"><B>Default AppleScript Macros</B></FONT></TD>
</TR>
</TABLE>
<P><font size="2" face="Lucida Grande,Geneva,Arial"> TeXShop 1.33 comes with an extended collection of
Applescripts by Claus Gerhardt and others. Many of these scripts automate workflow when a series of typesetting commands must be issued in sequence. By copying and modifying the scripts, users can construct scripts appropriate for their own workflow.  
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">In this section, we will describe some of these scripts. 
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
<B>Convert to Mac, Convert to Unix, Convert to Windows: </B>
</font></P>


<P><font size="2" face="Lucida Grande,Geneva,Arial">
In the early days, teletype terminals were used for communication. The ascii character set still has remnants from those days; for instance 0x07 rings the teletype bell. The
character 0x0a was a line feed which turned the carriage to the next line and the character 0x0d was a carriage return which pulled the carriage back to the start of the line. To get a line feed, one used the sequence 0x0d 0x0a.</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
After the age of teletypes ended, computer manufacturers selected different subsets of these characters  to indicate a line feed. In the Unix world, 0x0a was used, in the Windows world 0x0d 0x0a was used, and in the old Macintosh Classic world 0x0d was used. Apple's guidelines for Mac OS X state that programs should be able to automatically open files using any of these conventions. Most programs including TextEdit, TeXShop, etc., follow these guidelines. In TeXShop, new files are created using Unix conventions, but if you load a file created with Mac OS Classic and then add extra lines, old portions of the document will be saved with the Classic convention and new sections will have the Unix convention.   
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
These line feeds cause no trouble until you send a file to a friend using a different operating system.
Many editors now understand multiple line feed conventions, so often you'll have no problems. But if you
do, use the scripts above. Suppose the source file for a document is named
MyFile.tex. Then "Convert to Mac" will create a new file named MyFile_Mac.tex with the same source
code and Macintosh line feed conventions. "Convert to Unix" and "Convert to Windows" work the same way.
All of these scripts call a binary program by Craig Stuart Sapp named "flip" in ~/Library/TeXShop/bin. See
http://ccrma-www.stanford.edu/~craig/utility/flip/ for details.
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
<B>Other Scripts->Bibliography:</B>
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
Processing a file with a bibliography requires multiple typesetting operations. First Latex is run to create an .aux file. Then Bibtex is run and uses this file to create .bbl and .blg files. Latex is run again to add the bibliography to the document. Latex is run a final time to update the references to the bibliography in the text.   
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
The "Bibliography" command does all of these things one by one. First it saves the file. Then
it runs latex->bibtex->latex->latex. Finally it updates the preview display.
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
<B>htlatexc, htlatexr:</B>
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
Tex4ht is a TeX program which converts a latex document into a web page. The source can be a standard
Latex file and can include eps illustrations. The end result is an html page and a large number of
gif files. The script command "htlatexc" saves the source documents, runs htlatex, and opens the resulting html file in Safari. Thus it behaves like a new TeXShop typesetting command, except that it was
constructed by a user without waiting for new TeXShop code!  
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
When using these scripts, it is not necessary to use the package text4ht since this package will automatically be loaded. The script htlatexc calls htlatex without additional options. The script htlatexr calls it with the option "-r", which tells the program to recreate any .gifs which already exist.
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
<B>pdfselectc:</B>
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
This script runs the shell script pdfselect to create pdf files containing only certain selected
pages of a document. When it is run, a dialog appears asking for the number of pdf files to be
created. Suppose we answer 3. Next a dialog appears asking for the range for the first document.
Suppose we answer 5:8. A dialog appears asking for the range of the second document. Suppose we
answer 10. A dialog asks for the range of the third document. Suppose we answer 20:30. We will
then obtain three documents, one containing pages 5 - 8 of the original, one containing page 10,
and one containing pages 20 - 30.
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
<B>mpostc, mpostcpl, latex-makeindex-mpost:</B>
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
The script mpostc runs mpost and then pdflatex; the script mpostcpl runs pdflatex, and then mpost, and then pdflatex again.
See the TeXShop help file General: Context and Metapost for an example of the use of these three
commands in sequence.</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial"> 
The script latex-makeindex-mpost saves the source and runs pdflatex, makeindex, mpost, and pdflatex again, opening relevant log files in the process. 
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">
<B>Others:</B>
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">The TeXShop_Folder included
in the TeXShop distribution contains a subfolder named Scripts by Claus Gerhardt with
additional scripts and extensive documentation. Please consult it for further details.

	</BODY>

</HTML>