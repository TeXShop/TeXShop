<HTML>

<HEAD>
		<META HTTP-EQUIV="content-type" CONTENT="text/html;charset=iso-8859-1">
		<TITLE>Writing Scripts with TeXShop Typesetting Commands</TITLE>
		<META NAME="copyright" CONTENT="Copyright (c) 2003 Richard Koch under the GNU FDL">
		<META NAME="description" CONTENT="applescript">
	</HEAD>

<BODY BGCOLOR="#ffffff">
		<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%">
<TR HEIGHT="40">
<TD WIDTH="40" HEIGHT="40"><a href="../TeXShop%20Help.html"><IMG HEIGHT="40" WIDTH="40" border="0" SRC="../gfx/xicnsc.gif"></a></TD>
<TD WIDTH="6" HEIGHT="40"></TD>
<TD HEIGHT="40" VALIGN="middle"><FONT FACE="Lucida Grande,Helvetica,Arial" SIZE="4"><B>Writing Scripts with TeXShop Typesetting Commands</B></FONT></TD>
</TR>
</TABLE>
	<P><font size="2" face="Lucida Grande,Geneva,Arial"> If a TeX project contains a bibliography,
a sequence of typesetting commands must be run to update the bibliography. Latex is run first to create
an .aux file. Bibtex is run to create .bbl and .blg  files from this .aux file. 
Latex is run again to add the bibliography to the document. Latex is run a final time to update the references to the bibliography in the document.
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial"> Your projects may contain similar sequences of typesetting commands. It is possible to use applescript to automate these sequences. 
</font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial"> To see how to do that we'll examine the
OtherScripts->Bibliography command which comes with TeXShop. Here is the body of that command
<dl>
<dd>--Applescript
<p>
<dd>set fileName to #FILEPATH#
<dd>if fileName is equal to  ""
<dd>activate
<dd>display dialog "Please save the file first"  buttons {"OK"} default button "OK"
<dd>return
<dd>end if
<p>
<dd>set frontName to #DOCUMENTNAME#<dd>tell application "TeXShop"<dd>save document frontName<dd>end tell
<p>
<dd>tell document frontName of application "TeXShop" 
<p>
<dl>
<dd>	latexinteractive
<p>
<dd>	repeat
<dl>
<dd>		delay 2
<dd>		if taskdone
<dd>			exit repeat
<dd>		end if
</dl>
<dd>	end repeat
<p>
<dd>
<dd>	bibtex
<p>
<dd>	repeat
<dl>
<dd>		delay 2
<dd>		if taskdone
<dd>			exit repeat
<dd>		end if
</dl>
<dd>	end repeat
<p>
<dd>	latex
<p>
<dd>	repeat
<dl>
<dd>		delay 2
<dd>		if taskdone
<dd>			exit repeat
<dd>		end if
</dl>
<dd>	end repeat
<p>
<dd> latex
<p>
</dl>
end tell
</dl>
</font></P>



		<P><font size="2" face="Lucida Grande,Geneva,Arial">The first line of this command indicates that this is an AppleScript macro. The next lines check #FILEPATH#, a parameter which gives the full path to the tex source. This parameter is an empty string when a new document has been created and not yet saved. In that case the user is asked to save the document and the script ends.
</font></P>

 <P><font size="2" face="Lucida Grande,Geneva,Arial">The next line tells TeXShop to save the document. Notice that we use #DOCUMENTNAME# to refer to the document in question. </font></P>

<P><font size="2" face="Lucida Grande,Geneva,Arial">The remaining commands run latexinteractive, bibtex, latex, and
latex. Recall that control returns to applescript immediately after calling a typesetting command
before the typesetting job is over. The repeat loop tells the script to check whether the job is complete before running another typesetting task. The line "delay 2" causes applescript to pause rather than continually asking if the task is done and thereby slowing the entire computer down.
</font></P>


	</BODY>

</HTML>