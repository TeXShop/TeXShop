<HTML>

<HEAD>
			<META HTTP-EQUIV="content-type" CONTENT="text/html;charset=Shift_JIS">
			<TITLE>AppleScript マクロ</TITLE>
			<META NAME="copyright" CONTENT="Copyright (c) 2003 Richard Koch under the GNU FDL">
			<META NAME="description" CONTENT="AppleScriptを実行するタイプのマクロ">
			<link href="../sty/screen.css" rel="stylesheet" media="all">
</HEAD>


<BODY>
<div id="content_border">

<p>
マクロが次のいずれかの文字列で始まっている場合──
</p>

<tt>
		<dl>
			<dd>--AppleScript
			<p>
			<dd>--AppleScript direct
		</dl>
</tt>

<p>
そのマクロを選択すると、AppleScript のコードが実行されます。
たとえば「View pdf with Acrobat」と題されたマクロを考えてみます。
ソースファイルがアクティブになっている（加えて pdf ファイルもすでに生成済みになっている）ときにこのマクロを選択すると、
Adobe Acrobat Reader が立ち上がって pdf 出力ファイルを開きます。
この AppleScript のコードは、次のようになっています──
</p>

<tt>
		<dl>
			<dd>--AppleScript direct
			<dd>
			<dd>tell application &quot;Acrobat Reader 5.0&quot;
					<dl>
						<dd>activate
						<dd>open POSIX file #PDFPATH#
					</dl>
			<dd>end tell
		</dl>
</tt>

<p>
「--AppleScript direct」で始まるコマンドは、TeXShop により直接実行されます。この AppleScript が実行されている間は、TeXShop のイベント・ループは有効になりません。したがってこのスクリプトには、TeXShop を呼び出して、ユーザの入力を必要とするかもしれない動作を行なわせることはできません。たとえば、TeXShop に LaTeX を実行するよう要請することができません──というのも、LaTeX ファイルにエラーがあった場合、コンソールが表示されユーザの入力を待ちますが、そうした入力はできないのです。
</p>

<p>
「--AppleScript」で始まるコマンドは、TeXShop に組み込まれている小さな補助プログラムにより実行されます。こうしたコマンドは、ユーザの入力を必要とするかもしれない動作を行なうことを TeXShop に要求できます──というのも、この場合、補助プログラムは一時的に停止しますが、TeXShop はアクティブのままだからです。
</p>

<p>
なので「--AppleScript direct」構文はルーティン・マクロに適していますが、手の込んだマクロには「--AppleScript」が必要となるでしょう。
</p>

</div>
<div id="header_background"></div>
<div id="header_logo"><a href="../TeXShop%20Help.html"><IMG HEIGHT="40" WIDTH="40" border="0" SRC="../gfx/xicnsc.gif"></a></div>
<div id="header_chapter">マクロ・ヘルプ</div>
<div id="header_title">AppleScript マクロ</div>

<div id="menu_border">

	<UL>
		<li><a href="macros_preliminaries.htm">まえがき</a> 
		<li><a href="macros_default.htm">デフォルトのマクロを理解する</a>
		<li><a href="macros_rearrange.htm">マクロの項目名を並べ替える</a>
		<li><a href="macros_define.htm">新しいマクロを定義する</a>
		<li><a href="macros_applescript.htm">AppleScript マクロ</a>

		<li><a href="macros_includedscripts.htm">デフォルトの AppleScript マクロ</a>
		<li><a href="macros_defapplescript.htm">AppleScript マクロを定義する</a>
		<li><a href="macros_dialogs.htm">ダイアログを作る</a>
		<li><a href="macros_writingcompletescripts.htm">TeXShop のタイプセットコマンドでスクリプトを書く</a>
		<li><a href="macros_writingcommandscripts.htm">シェルコマンドでスクリプトを書く</a>
	</UL>
</div>
</BODY>

</HTML>
